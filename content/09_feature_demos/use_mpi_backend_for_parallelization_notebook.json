{
    "full_executed": false,
    "use_mpi_backend_for_parallelization_notebook.ipynb": {
        "7.7: Use MPI backend for Parallelization": {
            "level": 1,
            "html": "<div class='markdown-cell'>\n    <h1>7.7: Use MPI backend for Parallelization</h1>\n<p>This example demonstrates how to use the MPI backend for simulating\ndipoles using HNN-core.</p>\n<p>The MPI backend allows running the simulation in parallel across\nneurons in the network even with a single trial. For this, you will need\nthe <a\nhref=\"https://github.com/jonescompneurolab/hnn-core?tab=readme-ov-file#installation\">MPI\nrelated software</a> installed. Note that if you want to simulate in\nparallel across trials, the Joblib backend allows this without the need\nto install and configure MPI.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        # Authors: Mainak Jas <mjas@mgh.harvard.edu>\n#          Blake Caldwell <blake_caldwell@brown.edu>\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Let us import <code>hnn_core</code></p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        import os.path as op\n\nimport matplotlib.pyplot as plt\n\nimport hnn_core\nfrom hnn_core import simulate_dipole, jones_2009_model\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Following our <a\nhref=\"https://dylansdaniels.github.io/website_redesign/content/06_alpha_beta/api.html\">Alpha\nexample</a>, we add a ~10 Hz \"bursty\" drive starting at 50 ms and\ncontinuing to the end of the simulation. Each burst consists of a pair\n(2) of spikes, spaced 10 ms apart. The occurrence of each burst is\njittered by a random, normally distributed amount (20 ms standard\ndeviation). We repeat the burst train 10 times, each time with unique\nrandomization.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        net = jones_2009_model()\n\nweights_ampa = {'L2_pyramidal': 5.4e-5, 'L5_pyramidal': 5.4e-5}\nnet.add_bursty_drive(\n    'bursty', tstart=50., burst_rate=10, burst_std=20., numspikes=2,\n    spike_isi=10, n_drive_cells=10, location='distal',\n    weights_ampa=weights_ampa, event_seed=278)\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Finally, to simulate we use the <a\nhref=\"https://jonescompneurolab.github.io/hnn-core/stable/generated/hnn_core.parallel_backends.MPIBackend.html#hnn_core.parallel_backends.MPIBackend\">MPIBackend</a>\nclass. This will start the simulation across the number of processors\n(cores) specified by <code>n_procs</code> using MPI. The\n<code>mpiexec</code> launcher is used from <code>openmpi</code>, which\nmust be installed on the system.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        from hnn_core import MPIBackend\n\nwith MPIBackend(n_procs=2, mpi_cmd='mpiexec'):\n    dpls = simulate_dipole(net, tstop=310., n_trials=1)\n\ntrial_idx = 0\ndpls[trial_idx].plot(show=False)\nplt.show()\n    </code>\n</div>"
        }
    }
}